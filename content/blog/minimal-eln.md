---
title: オープンソースでミニマルな電子実験ノート(ELN)を実装する
dateCreated: 2021-07-29
dateModified: 2021-07-29
tags:
  - electronic lab notebook
  - trusted timestamping
---


### 要点

- 電子実験ノート(ELN)が欲しかったのでオープンソースのものでDIYしました
- VSCodeのMarkdown PDFは便利
- タイムスタンプはOpenSSLで作成できる
- クラウドストレージやspotlightの全文検索を活用しよう


### 環境

- MacOS 11.4
- VSCodium 1.57.1
  - Markdown PDF 1.4.4
- OpenSSL 1.1.1h


### どうしてこうなった...

- [eLabFTW](https://www.elabftw.net/)を試用していたが、日本語環境の対応が遅れていて実用に耐えなかった。メジャーバージョンアップ時にデータベースが文字化けで死んだのでこれを機にやめた。
- そもそも実験ノートになぜサーバが必要なのか
- 書いたMarkdownがPDFになってタイムスタンプが押せればそれはELNと言えるのでは
- 整理などしなくてもspotlightやクラウドストレージの全文検索で検索すれば必要な情報に辿り着けるのでは


### 最低限の機能

1. Markdownエディタ

   構造的な文書が平易な文法で書けるという点でほぼ一択なのかと思います。一応画像を貼ることもできるので写真やスペクトルデータの添付にも困りませんね。

1. タイムスタンプ認証局(TSA)の認証によるタイムスタンプの付与

   データの真正性の確保の点で電子実験ノートに必須の機能です。認証局のタイムスタンプがあることでファイルが特定の日時に存在していたことを証明でき、改竄を防ぐことができます。

1. 全文検索可能なデータベース

   たくさんのノートを引っ張り出して片っ端からページをめくらなくても、一瞬で検索できるのが電子実験ノートの強みです。


### VSCodeを使ってMarkdownで実験ノートを書く

VSCodeはデフォルトでMarkdownが書けます。F1メニューでPreview->画面分割してプレビューしながら編集できるのも良いですね。

画像はMarkdownだとサイズ変更できないので、imgタグで適当な大きさにします。直接エディタに画像をドラッグアンドドロップで貼り付けられるプラグインもあるようです。


### Markdown PDFプラグインでPDFに変換する

Markdown PDF
https://marketplace.visualstudio.com/items?itemName=yzane.markdown-pdf

Markdown PDFプラグインをインストールします(VSCodiumの場合はMarketplaceにないのでvsixでインストールします)。F1メニューもしくは右クリックメニューでExport (pdf)すると同じ階層にPDFが出力されます。


### タイムスタンプの作成

1. タイムスタンプのリクエストファイル(PDFのハッシュ)を生成する

1. タイムスタンプ認証局にリクエストを送信して、レスポンスファイルを受信する

フリーのタイムスタンプ認証はいくつかありますが、今回は学術用途では自由に利用できるドイツのDFNの認証局を利用します。



1. リクエストとレスポンスを検証する




1. タイムスタンプの中身を確認する




### 実験ノート、データの保管と検索

作成したPDFとタイムスタンプ関連ファイルをクラウドに保管します。ファイル名の命名規則やフォルダ構造で、時系列あるいは分類別などで整理して保管します。

クラウド提供の全文検索機能を使うことで、実験条件や試薬など割と細かい条件でもそこそこ見つけ出すことができます。クラウドが利用できない場合はローカルでMacのspotlightを活用すると同様の検索が可能です。


### 課題

- タイムスタンプの有効期限
- 事務方に「ノートを確認したいから紙で提出しろ」と言われた時の対応