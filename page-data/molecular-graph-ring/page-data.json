{"componentChunkName":"component---src-templates-post-js","path":"/molecular-graph-ring/","result":{"data":{"site":{"siteMetadata":{"title":"mojaie.github.io","siteUrl":"https://mojaie.github.io","author":{"name":"Seiji Matsuoka","summary":"Cheminformatics, Biointeraction and Laboratory automation"},"license":"CC BY 4.0","licenseURL":"https://creativecommons.org/licenses/by/4.0/legalcode","social":{"twitter":"mojaie"}}},"markdownRemark":{"id":"2e30c4a9-b93e-5307-b21d-f849d1ff2253","excerpt":"環の検出 化学構造における環(ring, cycle)は、分子グラフの閉路(cycle…","html":"<h3>環の検出</h3>\n<p>化学構造における環(ring, cycle)は、分子グラフの閉路(cycle)に相当します。グラフを探索する(ある一点のノードから隣接ノードを順番に辿って他の全てのノードへの経路を出力する)とそのグラフが閉路を持つかどうかを知ることができます。既に到達したノードに別の経路から到達することができればそのグラフには閉路があります。</p>\n<p>💡<span class=\"tip\">ここでは、同じノードを２回以上通らない単純閉路(simple cycle)を単に閉路と呼びます。スピロ環のような構造は2つの閉路が1つのノードで接しているとみなします。</span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3f5b52efbad855cc4d868d13bb62325b/0a47e/spanning.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.24324324324324%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsSAAALEgHS3X78AAAA90lEQVQoz6VR2W6EMBDj/79vFVZZCCQUtKSsKs4216SGVKgrtX3pPARPsMceyOI/KksPY8y2bd7733hCCM55VVVP4hDC+1EA67paawHO18DLsjRNI6UiIoCyLKdpcs7tYgjmeYYzGvDgjxuKRCZETV3VsutVFdxtMwht2zKWI4KUchenGeM4YgTEwEhhrIk+krZD3cAQl28vqrjd+OXirUXLGEPGDFZg40zOGAHnMzat46PvX7V2D+1D8Oajr0WtVH0svztDnLbF+X3hiPSB+vtdFAVs99hdl+f5MAxfOydaGvHj106xu0OGbZPs6Vf9UXTUCc4W9Qln7Ak5EVI84wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Spanning tree\"\n        title=\"Spanning tree\"\n        src=\"/static/3f5b52efbad855cc4d868d13bb62325b/fcda8/spanning.png\"\n        srcset=\"/static/3f5b52efbad855cc4d868d13bb62325b/12f09/spanning.png 148w,\n/static/3f5b52efbad855cc4d868d13bb62325b/e4a3f/spanning.png 295w,\n/static/3f5b52efbad855cc4d868d13bb62325b/fcda8/spanning.png 590w,\n/static/3f5b52efbad855cc4d868d13bb62325b/0a47e/spanning.png 600w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>上図の図は閉路を持つグラフに深さ優先探索(Depth first search, DFS)を行った例です。黒矢印で示した経路は、元のグラフと同じノード集合、および元のグラフのエッジ集合の部分集合から成り、かつ閉路を持たない連結グラフです。これをスパニングツリー(spanning tree)と呼びます。</p>\n<p>グラフにある閉路の数は、スパニングツリーに含まれないエッジの数と等しくなります。上図の例では橙色で示した4つのエッジが該当するので、4つの閉路があることになります。閉路の数はcircuit rankとも呼ばれます。</p>\n<p>📗<span class=\"note\">探索が1段階進むごとに探索済みのノードとエッジが一つずつ増えるので、連結グラフのスパニングツリーのエッジの数はノードの数-1になります。よって、circuit rankは[エッジの数] - [ノードの数] + [連結成分の数]の式でも求めることができます。</span></p>\n<p>📗<span class=\"note\">スパニングツリーの生成はDFSでもBFSでも可能ですが、それぞれの閉路を構成するノードのリストを得たい場合は、閉路を検出した際に遡ってノードを記録することが容易なDFSが採用されます。</span></p>\n<h3>Smallest set of smallest rings (SSSR)</h3>\n<p>これで環の個数は判明しましたが、多環式化合物のグラフを構成する経路の組み合わせはスパニングツリーのルートノードの選び方や探索方法によって大きく異なります。見た目の印象としては4つの六員環構造からなる下図左の組み合わせを得たいと考えるのが自然ですが、下図右のような組み合わせが得られる可能性もあります。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5c7c15613e27af807b0b700432be2005/0a47e/cyclebasis.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.24324324324324%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsSAAALEgHS3X78AAABV0lEQVQoz5VR226CQBDl/7+jj31tjGkaUmobJdpiCSh4QUBuwnJxubjFWbqsmrRJXzq72ezMmTmTmSN03Cg7/zeh42UUOjtfLFM5qcI/uVZONFU0O0Q9Sq+oABRolfqZ4ZQGQGuiSYBxTuBCeqZdXXWWnc81jbT1bK66KS7b8xmgL8a+fnKmO+PerTSW/JpMpACND1VYNgzeONHkbajIA3w8MLq9+bn20Cqv3WPVF5cbse9QuqunO0sUH2YqK4oJyFHB4pL0SCqbQmb5oyC2Q8XgQ3U6wi2AgJ0Zydal8kwmFgO8kSdt85e0cYuauebOm4+H+vsgS3zmntzMdVK7Jk7OO7ekadJloWrkI2I+kRme4C9C+VQtUD/G5i7eaqir2/0SGfs0bk5s6Nu2+XKx6mFxi/XgIt1NwuvfDYvFIl7bCH4IIfAU6LfPgsBf+ksnyu1Ccr03/Bsv5P2YYjQrbgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Cycle basis\"\n        title=\"Cycle basis\"\n        src=\"/static/5c7c15613e27af807b0b700432be2005/fcda8/cyclebasis.png\"\n        srcset=\"/static/5c7c15613e27af807b0b700432be2005/12f09/cyclebasis.png 148w,\n/static/5c7c15613e27af807b0b700432be2005/e4a3f/cyclebasis.png 295w,\n/static/5c7c15613e27af807b0b700432be2005/fcda8/cyclebasis.png 590w,\n/static/5c7c15613e27af807b0b700432be2005/0a47e/cyclebasis.png 600w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>分子グラフにおいては、環を構成するノード数の総計が最小になるような環の選び方が実用上好ましいと考えられています。このような組み合わせはSmallest set of smallest rings (SSSR)として知られています。SSSRの計算にはグラフの辺の重みを１としてminimum weight cycle basisを計算するアルゴリズムが利用できます。Hortonの方法や<a href=\"https://dare.uva.nl/search?identifier=93573ea1-c3ea-4321-a479-294c74b7f0bb\">[Coelho de Pina, 1995]</a><a href=\"https://doi.org/10.1007/s00453-007-9064-z\">[Kavitha et al., 2008]</a>などが知られています。</p>\n<p>💡<span class=\"tip\">SSSRは化学的な性質を示唆しません(例:ポルフィリンの18<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">π</span></span></span></span>芳香環はSSSRに含まれない)。外平面グラフでない分子グラフはしばしば化学者の直感から外れたSSSRを生成します(例:キュバンの立方体構造はグラフ理論上は一つの面がない凹型の箱のように扱われる)。</span></p>\n<p>閉路に含まれるエッジは1、含まれないエッジを0として、エッジ集合に対応させたビット列により閉路を表現することができます。グラフ全体としては長さがエッジ集合のサイズに等しいビット列を、閉路の数と同数持つことになります。このベクトル空間をfundamental cycle basisと呼びます。これらのビット列の間で排他的論理和をとると、2つの閉路が共有するもう一つの閉路になります(下図)。閉路の総数は決まっているので、既に検出されている大きい閉路を新しく検出されたより小さい環で更新していくことによりMinimum weight cycle basisを得ます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/93071daf8c9330ef3c939228655d22fb/0a47e/fundamental.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.486486486486484%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsSAAALEgHS3X78AAAA3klEQVQY06XQbU/DIBAHcL7/N/OFZplmE3VN2221m+vxDC0FTsps4ksTfy+O3OXgn0Cw0NqeXmm7f4H+GmJcRgkxJD//8Kt1MMcYSe5ZVR+fH0C00fv3zeMAwDlPIaILXHAppTGGFQAghJBFvkhE07l2h/h5hqfqbQ9dn1P7vp/D7HHKm9bacRy11vmJXO+tUiqHE3fhE6Ws2YBsrTGX+sCAf91uKfk0D5wvgfx+MDYUqliSc85kbENpS3fsevrYbqVSKSVMAYN2zo2/uGIqQggEV3JgXVXnn8E/I/gP38/XktmAfxnWAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Fundamental cycle basis\"\n        title=\"Fundamental cycle basis\"\n        src=\"/static/93071daf8c9330ef3c939228655d22fb/fcda8/fundamental.png\"\n        srcset=\"/static/93071daf8c9330ef3c939228655d22fb/12f09/fundamental.png 148w,\n/static/93071daf8c9330ef3c939228655d22fb/e4a3f/fundamental.png 295w,\n/static/93071daf8c9330ef3c939228655d22fb/fcda8/fundamental.png 590w,\n/static/93071daf8c9330ef3c939228655d22fb/0a47e/fundamental.png 600w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>📗<span class=\"note\">Minimum weight cycle basisを得るアルゴリズムは、mはエッジ数、nはノード数としたとき、現状効率的なものでも<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>m</mi><mn>2</mn></msup><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(m^2n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathdefault\">m</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord mathdefault\">n</span><span class=\"mclose\">)</span></span></span></span>と地味に計算コストが高いです<a href=\"https://doi.org/10.1007/s00453-007-9064-z\">[Kavitha et al., 2008]</a>。</span></p>\n<h3>多環式化合物のトポロジー</h3>\n<p>多環式化合物(polycyclic compound)のトポロジーは環と環の接合のしかたによって以下の4通りに分類されます。</p>\n<ul>\n<li>環と環が原子を共有していない</li>\n<li>環と環が原子を1つのみ共有している -> スピロ環(spiro ring)</li>\n<li>環と環が原子を2つ共有している -> 縮合環(fused ring)</li>\n<li>環と環が原子を3つ以上共有している -> 架橋環(bridged ring)</li>\n</ul>\n<p>つまり、環を構成するノード集合のintersectionのサイズで分類されます。</p>\n<p>articulation pointとbridge</p>\n<p>biconnected component スピロ以上\n2-edge connected component 縮合以上</p>\n<h3>Bemis-Murcko scaffold</h3>\n<p>環のトポロジーは医薬候補化合物の生理活性や有機合成戦略に大きく影響するファクターです。</p>\n<p>として知られるような、縮合した環の構造(fused ring)は生理活性や易合成性の観点から創薬においてしばしば注目されます。このような部分構造は、グラフとしてみると全てのノードが２つ以上のエッジで繋がっているので、2-edge connected componentと呼ばれます。どのエッジを一か所だけ切断しても２つ以上のコンポーネントに分解されない部分グラフ、とも言えます。</p>\n<p>逆に、一つのエッジを切断すると２つ以上のコンポーネントに分解される場合、そのエッジを橋(bridge)と呼びます。橋はHopcroft-Tarjanアルゴリズムの応用で検出できます（下記リンク参照）。元のグラフから橋を取り除くことで2-edge connected componentが残ります。</p>\n<p>Hopcroft-Tarjanのアルゴリズム(Biconnected component - Wikipedia)\n<a href=\"https://en.wikipedia.org/wiki/Biconnected_component\">https://en.wikipedia.org/wiki/Biconnected_component</a></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 400px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7377dc166bbd0d164211b17a767b4c4e/e17e5/twoedgeconnected.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.72972972972974%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABSklEQVQoz4VSDW+CMBT0//+jJSMmmGXGKQiDaSETmXxkJAhlsK5A+/ag0Thd4guBVx7Xu94xgZvquo5SKoSAezU5d1JKvKdpao/lOA7nvCzLJEniOL4DVmVZFtKqXUzT9H3fMIz5fJ7nOWMMGb4lHPuR7ApcVRVyqr5p6vXajJNkt9tFUaTr+kzXaV0bDPIrsDxdlmWno8ggDB3iqylyuq5Ly0KbPcUFPZ/xWrYU4sXZGParS8iyEUfO66qaTqdhGOL0cDgE+/0fMD6jDjwO5GfAb5g88habohOa/eZvtygevUDbDNN8/iwzoUAnMHqQdvDeQtrCwxcupbJg4zpKERr2qGmi75mEjxbErduNGCQUPazZsGNF6XK1UqMsy9A5bC7zv8hZSRmLSxgdBUKI53lBECwWiyGq05f/5HzGy4uXmBPStm17+5P8ArS+dELjeDA/AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"two-edge connected\"\n        title=\"two-edge connected\"\n        src=\"/static/7377dc166bbd0d164211b17a767b4c4e/e17e5/twoedgeconnected.png\"\n        srcset=\"/static/7377dc166bbd0d164211b17a767b4c4e/12f09/twoedgeconnected.png 148w,\n/static/7377dc166bbd0d164211b17a767b4c4e/e4a3f/twoedgeconnected.png 295w,\n/static/7377dc166bbd0d164211b17a767b4c4e/e17e5/twoedgeconnected.png 400w\"\n        sizes=\"(max-width: 400px) 100vw, 400px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>縮合環のデュアルグラフ</h3>","fields":{"slug":"/molecular-graph-ring/"},"frontmatter":{"title":"化学構造とグラフ理論(3): 環式化合物のトポロジー","dateCreated":"May 06, 2020","dateModified":"May 07, 2020","tags":["化学構造とグラフ理論","chemoinformatics","molecular graph"],"description":null}}},"pageContext":{"slug":"/molecular-graph-ring/","draft":true,"previous":{"fields":{"slug":"/molecular-graph-model/"},"frontmatter":{"title":"化学構造とグラフ理論(2): 分子グラフモデル","draft":false}},"next":{"fields":{"slug":"/argo-workflow-memo/"},"frontmatter":{"title":"Argoの環境構築","draft":false}}}}}