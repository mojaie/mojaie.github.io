{"componentChunkName":"component---src-templates-post-js","path":"/git-memo/","result":{"data":{"site":{"siteMetadata":{"title":"mojaie.github.io","siteUrl":"https://mojaie.github.io","author":{"name":"Seiji Matsuoka","summary":"Cheminformatics, Biointeraction and Laboratory automation"},"license":"CC BY 4.0","licenseURL":"https://creativecommons.org/licenses/by/4.0/legalcode","social":{"twitter":"mojaie"}}},"markdownRemark":{"id":"54f07923-f2a1-50e2-814f-cf75863fb156","excerpt":"GitHubのプルリクエストをローカルでテストする CLIからフェッチする。一旦フェッチするとSourcetreeからでも見ることができる。 ｀git fetch origin pull/プルリクエスト番号/head:ユーザ/ブランチ｀ Checking out pull requests locally https…","html":"<h3>GitHubのプルリクエストをローカルでテストする</h3>\n<p>CLIからフェッチする。一旦フェッチするとSourcetreeからでも見ることができる。</p>\n<p>｀git fetch origin pull/プルリクエスト番号/head:ユーザ/ブランチ｀</p>\n<p>Checking out pull requests locally<br>\n<a href=\"https://docs.github.com/en/free-pro-team@latest/github/collaborating-with-issues-and-pull-requests/checking-out-pull-requests-locally\">https://docs.github.com/en/free-pro-team@latest/github/collaborating-with-issues-and-pull-requests/checking-out-pull-requests-locally</a></p>\n<h3>Gitの基本コマンド</h3>\n<p>ブランチしない場合はこれだけ<br>\nSource Treeを使う場合はstagingに関するコマンドなどはあまり考えなくても大丈夫</p>\n<ul>\n<li>commit</li>\n<li>push</li>\n<li>fetch</li>\n<li>merge</li>\n<li>pull (fetch -> marge)</li>\n</ul>\n<h3>他のブランチの変更を現在のブランチに適用</h3>\n<ul>\n<li>\n<p>Remoteにブランチをまだpushしてない場合</p>\n<ul>\n<li>rebase</li>\n<li>mergeでいいけどrebaseの方がコミットグラフは綺麗になる</li>\n</ul>\n</li>\n<li>\n<p>既にpushしている場合</p>\n<ul>\n<li>merge</li>\n<li>mergeしても引き続きどちらのブランチも平行して開発できる</li>\n<li>rebaseはブランチの履歴が変わるのでpush後は厳禁</li>\n<li>マージしたブランチを削除する場合はrebase->リモートブランチ削除でもいい</li>\n</ul>\n</li>\n</ul>\n<h3>コミットを取り消す</h3>\n<ul>\n<li>\n<p>Remoteにコミットをまだpushしてない場合</p>\n<ul>\n<li>コミットを取り消して作業コピーに戻す(stagingした状態に戻す)</li>\n<li>git reset</li>\n<li>コミットを取り消してその内容も全て破棄</li>\n<li>git reset —hard</li>\n<li>直近のコミットを修正して再コミットする場合</li>\n<li>git commit -amend</li>\n<li>merge(pull), rebaseを取り消す</li>\n<li>git reflogで履歴を確認</li>\n<li>git reset —hard 戻りたいコミット</li>\n</ul>\n</li>\n<li>\n<p>既にpushしている場合</p>\n<ul>\n<li>pushした履歴は取り消せないのでamendは厳禁</li>\n<li>変更を元に戻す新しいコミットを作成する</li>\n<li>git revert</li>\n<li>ローカルとリモート両方の履歴ごと消す</li>\n<li>共同作業者がいる場合は厳禁</li>\n<li>git reflog、reset —hardでローカルの履歴を戻し、push —force</li>\n</ul>\n</li>\n</ul>\n<h3>ブランチ切り替え</h3>\n<ul>\n<li>\n<p>コミットしていない変更がある場合、ブランチは切り替えられない</p>\n<ul>\n<li>まだコミットしていない変更を破棄(作業コピーを破棄してreset)</li>\n<li>git reset —hard</li>\n<li>ブランチ切り替えの前にコミットしてない変更を一時退避</li>\n<li>git stash</li>\n</ul>\n</li>\n</ul>\n<h3>ブランチの変更内容をまとめてマージ</h3>\n<p>対話的rebaseもしくはmergeでsquash</p>\n<h3>push to deploy</h3>\n<p>古いバージョンではリモートをnon-bareで作成  </p>\n<ul>\n<li>リモートでgit config —add receive.denyCurrentBranch ignore</li>\n<li>hooks/post-receiveを作成</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">#!/bin/sh\ncd 作業ディレクトリ\ngit --git-dir=.git reset --hard HEAD</code></pre></div>\n<p>git 2.3以降の場合は  </p>\n<ul>\n<li>git config —add receive.denyCurrentBranch updateInstead</li>\n<li>これでHEADが一致した状態でのpushしか受け付けないし、作業コピーも更新してくれるっぽい</li>\n</ul>\n<p>どちらにせよ複数人で一つのリポジトリにdeployするのは良くないし、作業用リポジトリ>テスト用リポジトリ-デプロイ用リポジトリのような形にすべき</p>\n<h3>assume-unchangedとskip-worktree</h3>\n<ul>\n<li>\n<p>git update-index —assume-unchanged ほげほげ</p>\n<ul>\n<li>そのファイルは未更新とする（作業コピーがmergeで上書きされ、reset —hardで消される）</li>\n</ul>\n</li>\n<li>\n<p>git update-index —skip-worktree ほげほげ</p>\n<ul>\n<li>そのファイルのローカルでの更新を（mergeやreset —hardの後も作業コピーが残る）</li>\n</ul>\n</li>\n<li>git update-index —no-assume-unchanged</li>\n<li>git update-index —no-skip-worktree</li>\n</ul>","fields":{"slug":"/git-memo/"},"frontmatter":{"title":"Gitメモ","dateCreated":"February 19, 2021","dateModified":"February 19, 2021","tags":["git","GitHub","Sourcetree"],"description":null}},"file":null},"pageContext":{"slug":"/git-memo/","draft":false,"image":null,"previous":{"fields":{"slug":"/latex-mac-memo/"},"frontmatter":{"title":"LaTeXメモ (macOS)","image":null,"draft":false}},"next":{"fields":{"slug":"/no_clamshell/"},"frontmatter":{"title":"macOSでクラムシェルモードを無効化する","image":null,"draft":false}}}},"staticQueryHashes":["2841359383","3266777773","401191528"]}