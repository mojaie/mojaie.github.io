{"componentChunkName":"component---src-templates-post-js","path":"/molecular-graph-model/","result":{"data":{"site":{"siteMetadata":{"title":"mojaie.github.io","siteUrl":"https://mojaie.github.io","author":{"name":"Seiji Matsuoka","summary":"Cheminformatics, Biointeraction and Laboratory automation"},"license":"CC BY 4.0","licenseURL":"https://creativecommons.org/licenses/by/4.0/legalcode","social":{"twitter":"mojaie"}}},"markdownRemark":{"id":"b9b4234b-2350-5129-a6fb-b4cd43423ed0","excerpt":"分子グラフモデル 分子のトポロジーを表現するデータ構造として、分子グラフ(molecular graph)がしばしば用いられます。ここで言うグラフとは、頂点(ノード、node)とそれらを結ぶ辺(エッジ、edge)から構成されるデータ構造のことです。 グラフ(データ構造) - Wikipedia https://ja…","html":"<h3>分子グラフモデル</h3>\n<p>分子のトポロジーを表現するデータ構造として、分子グラフ(molecular graph)がしばしば用いられます。ここで言うグラフとは、頂点(ノード、node)とそれらを結ぶ辺(エッジ、edge)から構成されるデータ構造のことです。</p>\n<p>グラフ(データ構造) - Wikipedia<br>\n<a href=\"https://ja.wikipedia.org/wiki/%E3%82%B0%E3%83%A9%E3%83%95_(%E3%83%87%E3%83%BC%E3%82%BF%E6%A7%8B%E9%80%A0)\">https://ja.wikipedia.org/wiki/%E3%82%B0%E3%83%A9%E3%83%95_(%E3%83%87%E3%83%BC%E3%82%BF%E6%A7%8B%E9%80%A0)</a></p>\n<p>分子をグラフとしてみると、原子をノード(node)、結合をエッジ(edge)と置くことができます。それぞれのノードとエッジにはラベル(label)あるいは属性(attribute)などと呼ばれる情報を付与することができます。ノードに関する情報としては、元素記号(あるいは原子番号)、電荷、スピン多重度あるいは不対電子の数、質量などが挙げられます。一方、エッジに関する情報としては、結合次数が挙げられます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 554px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a0731c63484cff5a0cfde12500ad96f5/04abd/molgraph.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.513513513513516%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA3XAAAN1wFCKJt4AAABu0lEQVQoz2NgQAP/obhqaQuY7/FkO0P+5r1g9uX/lxn/M1wWvLTrXNLZK+dtQWLXrl1jBNEH9u5lOHfiBNwcTiAGS9wH4mcKUmBB1xe7GIEGMrq+2MFw0nEvw4z/h8Fq9m7dXbRn354AMHvffiY3VQaG2WGuKA4TFYYaiHDqf1Ru4HsGnv8MjP+l/3NGMuiBbGQHic+ZOoEZ3ZccQKzGBVXwhYFB7CcHmxqI7fR6ryrQhfM9n2wPgAYHKxCz7N17sGPL5o2ZyIbsWbXM6tqWLStAbEkuiJdlgE7UAGoQPG1vxA2ScH+6I8b/18n/Lk+3d/9n/8+0Y/f2eAkGBpXVa9fYTZs2zRCoSfHkqdMzS/OzzT0sjRWv7NhpB7ehkoGBN4WBwQDd+d6Pd+hy/tzKd23bfunTZ87MbJq2jBMmp5W/mGn50sVFNy6cEoFr2I2IXS4gVoPF9Jz6NAZcYOmyZUx7V88FekiU0UVVQuP/bAYmBp1SxitbNzIxLIMqes3AwPQOEp4MtySEGaBeZgCGH6Pt650MfwpmMNy4c5tx48aNDGtWgIOKYe6yJTwvT566dPfAIXUQ/97Bw4wAWLelZeetU3gAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Molecular graph\"\n        title=\"Molecular graph\"\n        src=\"/static/a0731c63484cff5a0cfde12500ad96f5/04abd/molgraph.png\"\n        srcset=\"/static/a0731c63484cff5a0cfde12500ad96f5/12f09/molgraph.png 148w,\n/static/a0731c63484cff5a0cfde12500ad96f5/e4a3f/molgraph.png 295w,\n/static/a0731c63484cff5a0cfde12500ad96f5/04abd/molgraph.png 554w\"\n        sizes=\"(max-width: 554px) 100vw, 554px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>💡<span class=\"tip\">有機化学における構造式と同様に、水素はしばしば省略されます。</span></p>\n<p>原子のノードを結合のエッジで接続した分子グラフは非常に単純なデータ構造ですが、特に低分子有機化合物を扱う創薬化学の分野において広く利用されています。</p>\n<p>このモデルのグラフとしての特徴を以下に挙げます。</p>\n<ul>\n<li>\n<p>無向グラフ(undirected graph)</p>\n<p>分子グラフは一般的にエッジに向きが無い無向グラフとして表現されます。ちなみに、エッジに向きがある（一方通行の経路が存在する）グラフは有向グラフ(directed graph)と言います。</p>\n</li>\n<li>\n<p>単純グラフ(simple graph)</p>\n<p>分子グラフは一般的にループ(self-loop、同一ノードを接続するエッジ)を持ちません。また多重辺(multi-edge、２つのノードの間に２本以上あるエッジ)を持ちません。ループと多重辺を持たないグラフを単純グラフと呼びます。</p>\n</li>\n<li>\n<p>有限グラフ(finite graph)</p>\n<p>ノード数が無限ではないグラフを有限グラフと呼びます。ノード数が無限であるグラフは無限グラフ(infinite graph)です。</p>\n</li>\n</ul>\n<p>💡<span class=\"tip\">それぞれの分子グラフは隣接するノードを辿ることで任意のノードに到達することのできる連結グラフ(connected graph)です。しかし、実際の化合物データは水和水や金属カチオンを含む塩など、複数の分子の混合物の場合もあるので、その場合は非連結グラフ(disconnected graph)となります(イオン結合や水素結合は通常分子グラフのエッジとはみなされません)。</span></p>\n<p>分子グラフは分子のトポロジーの取り扱いを容易にしますが、適用範囲には限りがあります。</p>\n<ul>\n<li>ホウ素化合物の三中心二電子結合など、非古典的な結合の中には単純グラフでは表せない化学構造が存在します。</li>\n<li>実際の分子は電荷や多重結合をそれぞれの原子や結合が離散的に(discrete)持っているわけではなく、複数の原子や結合にまたがる連続的な(continuous)分布として持っています。例えば芳香族性もヒュッケル則に従って単純に「ある」か「ない」かを決められるわけではなく、実際には「弱い芳香族性」を持つような化合物も数多く存在します。</li>\n<li>経験的には、分子グラフが適用されうる範囲は主に有機低分子化合物です。有機高分子や無機化学を取り扱う場合は、用途に応じてより適切なモデルを利用する必要があります。</li>\n</ul>\n<p>📗<span class=\"note\">化学構造式は各種スペクトル分析によって実験的に決定することが可能ですが、電荷や電子密度の連続的な分布を直接観測することは現代においても非常に困難です。有機化学者は経験則(有機電子論)に基づいて、化学構造式から電荷や電子密度の分布を推測し、現実の分子の相互作用および反応機構の解釈を試みます。近年では分子軌道シミュレーションを利用して手軽に電荷や電子密度の分布を予測し、反応機構のより強力な裏付けを得ることができるようになりました。</span></p>\n<h3>分子グラフの統計的特徴</h3>\n<p>原子がとりうる結合の数(価数、valence)には限りがあるため、実用上取り扱う低分子有機化合物の分子グラフには次のような傾向があります。</p>\n<ul>\n<li>\n<p>ノードの次数は1-4</p>\n<p>あるノードに接続するエッジの本数のことをそのノードの次数(degree)と呼びます。有機元素(C,H,O,N,P,S,ハロゲン)の価数は1から4の間にあるので、分子グラフのノードの次数の分布は1から4の間に集中します。遷移金属の配位や超原子価分子などで４を超えることもありますが、稀です。</p>\n<p>ノードの次数が1-4のグラフは、ノード数が10から30程度の創薬候補化合物を想定した場合、比較的疎らなグラフ(sparse graph)と言えます。</p>\n<p>💡<span class=\"tip\">ノードの次数が比較的高いグラフは密なグラフ(dense graph)です。</span></p>\n</li>\n<li>\n<p>ほぼ全てが平面グラフで、その中でも外平面グラフが多い</p>\n<p>平面グラフ(planar graph)とは、平面上にグラフを配置した際にエッジが交差しないノードの配置が少なくとも一つ存在するグラフです。テトラへドランやフラーレンは立体的に見えますが、平面グラフです(下図および<a href=\"https://en.wikipedia.org/wiki/Fullerene#/media/File:Graph_of_60-fullerene_w-nodes.svg\">C60のシュレーゲル図(Wikipedia)</a>参照)</p>\n<p>外平面グラフ(outerplanar graph)とは、平面グラフの中でも特に全てのノードがグラフの外縁に位置するようなグラフです。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 540px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/76dd6c0c36981af7226842556a80ba29/07484/planar.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.16216216216216%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsSAAALEgHS3X78AAAA/0lEQVQY001Q2W7EMAjM//9eVanqQ1fazek48RHfBlw7m1aZB4SAGRi6UgoRhROIWP6QAXwINf5XANBZ6xp8pdRK927M8/zzeDjvT60mcSj5/fnB2fJWr9E796zo+34YIOeLrJSqa8sNlBPpjQ5BilMK5SQ3BFuOvaRruPPeP18vNg5fMU3QdmJwIJjblkTFKZEEQ6sqP/MxbjMhBjbA3i7q6knGmOC8CG6VvHmTa8nRxCS1lsbWadAbSlZFoxKBT+lQaDUe4vR8XmUF3/sHOlMQQLKwju1teo98omApR9hnVFtBrF5QLAT5elgleD5ZuYHVl+0USK1oxP0Vt7Tlv+FgllRuvhpsAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"planar graph\"\n        title=\"planar graph\"\n        src=\"/static/76dd6c0c36981af7226842556a80ba29/07484/planar.png\"\n        srcset=\"/static/76dd6c0c36981af7226842556a80ba29/12f09/planar.png 148w,\n/static/76dd6c0c36981af7226842556a80ba29/e4a3f/planar.png 295w,\n/static/76dd6c0c36981af7226842556a80ba29/07484/planar.png 540w\"\n        sizes=\"(max-width: 540px) 100vw, 540px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>グラフを扱う数学的な問題の中には天文学的な計算量になりうるものもありますが、扱うグラフの対象を平面グラフ、外平面グラフ等に限定すればより効率的なアルゴリズムが発見されることもあるため、この分野における重要なアプローチの一つとなっています<a href=\"http://dx.doi.org/10.5936/csbj.201302004\">[Akutsu et al., 2013]</a>。</p>\n<p>📗<span class=\"note\">次数が低く、立体障害など空間的な制約もあるので、非平面の分子グラフは極めて稀です。おそらく天然低分子としては存在せず、狙って合成する必要があります。なお、実際に非平面グラフ分子の合成報告があります<a href=\"https://doi.org/10.1016/0040-4039(81)80077-9\">[Simmons et al., 1981]</a>。</span></p>\n</li>\n</ul>\n<h3>分子グラフの再構築(reconstruction)</h3>\n<p>SMILESやSDFileに文字列で格納された分子データを利用するためには、グラフを扱いやすいデータ構造に再構築する必要があります。グラフのソフトウェア上での実装方法は大きく分けて行列とリストの2通りです。</p>\n<ul>\n<li>\n<p>隣接リスト (adjacency list)</p>\n<p>それぞれのノードと隣接する(エッジで接続されている)ノードの一覧を配列に格納したものです。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">1: [2]\n2: [1, 3, 4]\n3: [2, 4]\n4: [2, 3]</code></pre></div>\n<p>隣接するノードのリストが提供されているので、グラフ上の経路を探索するアルゴリズムが高速に行えます。一方で、あるノードとノードの間にエッジがあるかどうかを検出する操作は、隣接するノードの数に比例した時間がかかります。そのため、実用上は配列ではなく連想配列(例: PythonのDict)やセット(例: PythonのSet)を用いることで定数時間で隣接ノードの有無をチェックできるようにした実装がよく見られます。また、連想配列やセットを用いることで、ノードに連番ではない任意のインデックスを使用することが可能です。</p>\n</li>\n<li>\n<p>隣接行列 (adjacency matrix)</p>\n<p>それぞれのノードとノードの間のエッジの有無(1か0)を正方行列に格納したものです。単純グラフの隣接行列は対角成分が0の対称行列になります。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">  1 2 3 4\n1 0 1 0 0\n2 1 0 1 1\n3 0 1 0 1\n4 0 1 1 0</code></pre></div>\n<p>ノードとノードの間にエッジがあるかどうかは定数時間で行うことができます。一方、それぞれのノードの隣接ノードのリストを得るためには、ノードの総数に比例した時間がかかります。また、分子グラフのような比較的疎らなグラフであってもノード数の二乗に比例したメモリが必要です(ただし、連想配列やセットの実装によっては多くのメモリを確保する場合もあるので、必ずしも隣接行列が非効率とは限りません)。グラフの行列表現はしばしば線形代数学的な解析手法(グラフスペクトル理論)に用いられ、これにより様々な機械学習手法でグラフを扱うことができるようになっています。</p>\n</li>\n</ul>\n<h3>分子グラフの利用可能な実装</h3>\n<p>実際に分子グラフを取り扱う際には、ケモインフォマティクス用のツールキットライブラリを利用すると便利です。その中には分子グラフの実装も含まれますので、実際にコードを読むとアルゴリズムやデータ構造についての理解が深められると思います。</p>\n<p>以下は、オープンソースで利用可能なものの例です。</p>\n<ul>\n<li><a href=\"http://openbabel.org/wiki/Main_Page\">OpenBabel</a> (C++)</li>\n<li><a href=\"https://lifescience.opensource.epam.com/indigo/\">Indigo</a> (C++)</li>\n<li><a href=\"https://cdk.github.io/\">Chemistry development toolkit, CDK</a> (Java)</li>\n<li><a href=\"https://rdkit.org\">RDKit</a> (Python)</li>\n<li><a href=\"https://bioconductor.org/packages/release/bioc/html/ChemmineR.html\">ChemmineR</a> (R)</li>\n<li><a href=\"https://github.com/mojaie/MolecularGraph.jl\">MolecularGraph.jl</a> (Julia)<span class=\"tip\"> 注) この記事の執筆者が開発中のライブラリです。</span></li>\n</ul>\n<p><a href=\"../molecular-graph-toc\">[化学構造とグラフ理論 目次]</a></p>","fields":{"slug":"/molecular-graph-model/"},"frontmatter":{"title":"化学構造とグラフ理論(2): 分子グラフモデル","dateCreated":"May 03, 2020","dateModified":"May 06, 2020","tags":["chemoinformatics","molecular graph"],"description":null}},"file":null},"pageContext":{"slug":"/molecular-graph-model/","draft":false,"image":"molecular-graph/planer.png","previous":{"fields":{"slug":"/molecular-graph-intro/"},"frontmatter":{"title":"化学構造とグラフ理論(1): 化学のデータを取り扱う","image":"molecular-graph/structuralisomers.png","draft":false}},"next":{"fields":{"slug":"/julia-package-binary/"},"frontmatter":{"title":"C/C++のライブラリをJuliaのパッケージとして登録する(Julia 1.3以降)","image":null,"draft":false}}}},"staticQueryHashes":["2841359383","3266777773","401191528"]}