{"componentChunkName":"component---src-templates-post-js","path":"/gatsby-image-filepath/","result":{"data":{"site":{"siteMetadata":{"title":"mojaie.github.io","siteUrl":"https://mojaie.github.io","author":{"name":"Seiji Matsuoka","summary":"Cheminformatics, Biointeraction and Laboratory automation"},"license":"CC BY 4.0","licenseURL":"https://creativecommons.org/licenses/by/4.0/legalcode","social":{"twitter":"mojaie"}}},"markdownRemark":{"id":"d98bbc9c-0128-5254-9d15-15cfe8c98d79","excerpt":"gatsby-imageで生成された画像ファイルがpublicのどこに保存されているのかわからなかった。 環境 gatsby: 2.21.16, gatsby-image: 2.4.2 frontmatterでTwitter cardに使う画像を設定する frontmatterのimage…","html":"<p>gatsby-imageで生成された画像ファイルがpublicのどこに保存されているのかわからなかった。</p>\n<h3>環境</h3>\n<ul>\n<li>gatsby: 2.21.16,</li>\n<li>gatsby-image: 2.4.2</li>\n</ul>\n<h3>frontmatterでTwitter cardに使う画像を設定する</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">title: hogehoge\nimage: images/cool_picture.png</code></pre></div>\n<p>frontmatterのimageを取得するところまではわかったが、src/component/seo.jsでtwitter:imageタグのcontentには絶対パスを渡さないといけないので、public以下のどのフォルダに生成された画像が保存されているのか知る必要があった。</p>\n<h3>GraphQL</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> pageQuery <span class=\"token operator\">=</span> graphql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n  query BlogPostBySlug($slug: String!, $image: String) {\n    markdownRemark(fields: { slug: { eq: $slug } }) {\n      id\n      excerpt(pruneLength: 160)\n      html\n      fields{\n        slug\n      }\n      frontmatter {\n        title\n        tags\n        description\n      }\n    }\n    file(relativePath: { eq: $image }) {\n      childImageSharp {\n        fixed {\n          src\n        }\n      }\n    }\n  }\n</span><span class=\"token template-punctuation string\">`</span></span></code></pre></div>\n<p>createPagesでpageQueryにfrontmatterのimageを渡して、relativePathがimageに一致するレコードを検索する(relativePathはgatsby-source-filesystemで指定したパスを基準にした相対パス)。childImageSharpのfixedやfluidなどに各環境用に生成する画像のプロパティが格納されており、その中のsrcにpublicを基準にした相対パスが入っているので、ベースURL(siteMetadata.siteUrl)と連結すればWeb上での絶対パスになる。</p>\n<p>あまり細かくドキュメントはされていないので、その都度gatsby developでGraphQLの構造の確認とクエリのテストをしておくのが良さそうである。</p>","fields":{"slug":"/gatsby-image-filepath/"},"frontmatter":{"title":"gatsby-imageで生成された画像ファイルのパス","dateCreated":"November 03, 2020","dateModified":"November 03, 2020","tags":["Gatsby","GraphQL","static site generator"],"description":null}},"file":null},"pageContext":{"slug":"/gatsby-image-filepath/","draft":false,"image":null,"previous":{"fields":{"slug":"/knime-input-widget/"},"frontmatter":{"title":"KNIME - コンポーネントを活用したワークフローのパラメータ管理","image":"knime-input-widget/many_configs.png","draft":false}},"next":{"fields":{"slug":"/personal-bookmark/"},"frontmatter":{"title":"ブックマーク","image":null,"draft":false}}}},"staticQueryHashes":["2841359383","3266777773","401191528"]}